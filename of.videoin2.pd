#N canvas 395 23 717 732 12;
#X obj 15 20 inlet;
#X obj 15 728 outlet;
#X obj 341 727 outlet;
#X text 447 731 RI;
#X obj 660 725 outlet;
#X obj 15 41 ofelia d -c13 video-\$0 \; local canvas = ofCanvas(this)
\; local args = canvas:getArgs() \; local outlet = ofOutlet(this) \;
video\$0 \, vtex\$0 \, vpix\$0 = ofVideoGrabber() \, ofTexture() \,
ofPixels() \; local id \, width \, height = args[1] \, args[2] \, args[3]
\; local opened \, devices \, dimg \, dsimg = 0 \, 0 \, ofTable() \,
ofTable() \; \; function M.new() \; ofWindow.addListener("setup" \,
this) \; if args[1] == nil then id = 0 end \; if args[2] == nil then
width = 320 end \; if args[3] == nil then height = 240 end \; M.setup()
\; end \; \; function M.free() \; video\$0:close() \; ofWindow.removeListener("setup"
\, this) \; end \; function M.setup() \; if ofWindow.exists then \;
video\$0:setDeviceID(id) \; video\$0:setup(width \, height) \; vtex\$0:allocate(video\$0:getWidth()
\, video\$0:getHeight() \, GL_RGBA) end end \; function M.dimen(list)
video\$0:setup(list[1] \, list[2]) vtex\$0:allocate(video\$0:getWidth()
\, video\$0:getHeight() \, GL_RGBA) end \; function M.close() video\$0:close()
end \; function M.listdev() devices = video\$0:listDevices() print(devices)
end \; function M.open(float) video\$0:close() if ofWindow.exists then
ofDisableArbTex() \; video\$0:setDeviceID(math.floor(float)) \; video\$0:setup(width
\, height) end end \; function M.draw(l) dimg = ofTable(table.unpack(l))
end \; function M.drawsubsection(l) dsimg = ofTable(table.unpack(l))
end \; function M.anchorpoint(l) vtex\$0:setAnchorPoint(table.unpack(l))
end \; function M.mirror(l) vpix\$0:mirror(l[1]==1 \, l[2]==1) end
\; function M.rotate(i) vpix\$0:rotate90(i) end \; function M.resize(l)
vpix\$0:resize(l[1] \, l[2]) vpix\$0:update() end \; function M.crop(l)
vpix\$0:crop(table.unpack(l)) end \; function M.getpixel(l) local p
= vpix\$0:getColor(l[1] \, l[2]) outlet:outletList(1 \, ofTable( p.r
\, p.g \, p.b \, p.a)) end \; function M.get() outlet:outletList(2
\, ofTable (video\$0:isInitialized() \, video\$0:getWidth() \, video\$0:getHeight()))
end \; \; function M.bang() \; video\$0:update() \; if video\$0:isFrameNew()
then \; vpix\$0 = video\$0:getPixels() vtex\$0:loadData(vpix\$0) end
\; if dimg[1] == 1 then vtex\$0:draw(table.unpack(dimg \, 2 \, #dimg))
end \; if dsimg[1] == 1 then vtex\$0:drawSubsection(table.unpack(dsimg
\, 2 \, #dsimg)) end \; vtex\$0:bind() \; outlet:outletBang(0) \; vtex\$0:unbind()
\; end \;;
#X f 93;
#X connect 0 0 5 0;
#X connect 5 0 1 0;
#X connect 5 1 2 0;
#X connect 5 2 4 0;
